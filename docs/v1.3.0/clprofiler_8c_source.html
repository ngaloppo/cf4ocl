<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>cf4ocl (C Framework for OpenCL): lib/clprofiler.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cf4ocl (C Framework for OpenCL)
   </div>
   <div id="projectbrief">Utilities and libraries for developing and benchmarking OpenCL projects in the C programming language.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">clprofiler.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="clprofiler_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*   </span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of cf4ocl (C Framework for OpenCL).</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * cf4ocl is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU Lesser General Public License as </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * published by the Free Software Foundation, either version 3 of the </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * cf4ocl is distributed in the hope that it will be useful, </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * License along with cf4ocl. If not, see </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="clprofiler_8h.html" title="Function headers of a profiling tool for OpenCL. ">clprofiler.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* Default export options. */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">static</span> <a class="code" href="structprofcl__export__options.html" title="Export options. ">ProfCLExportOptions</a> export_options = {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        .<a class="code" href="structprofcl__export__options.html#af95374946392a9c5b50bbfa9ea6762ed">separator</a> = <span class="stringliteral">&quot;\t&quot;</span>,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        .newline = <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        .queue_delim = <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        .evname_delim = <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        .simple_queue_id = TRUE,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        .zero_start = TRUE</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;};</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#ab1b31625c65ec819cf1e092da13c9cc0">   45</a></span>&#160;<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* <a class="code" href="clprofiler_8c.html#ab1b31625c65ec819cf1e092da13c9cc0" title="Create a new OpenCL events profile. ">profcl_profile_new</a>() {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">/* Allocate memory for new profile data structure. */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile = (<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="comment">/* If allocation successful... */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> (profile != NULL) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="comment">/* ... create table of unique events, ... */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a> = g_hash_table_new(</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        g_str_hash, </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                        g_str_equal);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <span class="comment">/* ... create table of command queues, ... */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a> = g_hash_table_new(</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                        g_direct_hash, </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                        g_direct_equal);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="comment">/* ... create list of all event instants, ... */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = NULL;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">/* ... and set number of event instants to zero. */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ad2570f72c56aeee39715780c0eba9ac3">num_event_instants</a> = 0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="comment">/* ... and create table of aggregate statistics. */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a> = g_hash_table_new_full(</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                        g_str_hash, </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        g_str_equal, </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        NULL, </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                        <a class="code" href="clprofiler_8c.html#a6188226c3bd091c865aca7db836038a1" title="Free an aggregate statistic. ">profcl_aggregate_free</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="comment">/* ... and set overlap matrix to NULL. */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a> = NULL;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="comment">/* ... and set timer structure to NULL. */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a> = NULL;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="comment">/* ... and set total times to 0. */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#abe40a36d90c6b5b30e547d91a638de2b">totalEventsEffTime</a> = 0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="comment">/* ... and set absolute start time to maximum possible. */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a88a3c702107196d5d1e761603ebd598e">startTime</a> = <a class="code" href="test__profiler_8h.html#ad35e68084e93d6aeb6191afa1fee5f22" title="OpenCL maximum unsigned long. ">CL_ULONG_MAX</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">/* Return new profile data structure */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">return</span> profile;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a89938a498a2b614e40fbf14ff5caa8a8">   91</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#a89938a498a2b614e40fbf14ff5caa8a8" title="Free an OpenCL events profile. ">profcl_profile_free</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">/* Profile to free cannot be NULL. */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">/* Destroy table of unique events. */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        g_hash_table_destroy(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">/* Destroy table of command queues. */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        g_hash_table_destroy(profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">/* Destroy list of all event instants. */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        g_list_free_full(profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, <a class="code" href="clprofiler_8c.html#af956e346e38f858f4608983a27fc853a" title="Free an event instant. ">profcl_evinst_free</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">/* Destroy table of aggregate statistics. */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        g_hash_table_destroy(profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">/* Free the overlap matrix. */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a> != NULL)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                free(profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">/* Destroy timer. */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a> != NULL)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                g_timer_destroy(profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">/* Destroy profile data structure. */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        free(profile);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#ae56bd39303113ae30aa5071fa1c2a6c2">  124</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#ae56bd39303113ae30aa5071fa1c2a6c2" title="Add OpenCL event to events profile, more specifically adds the start and end instants of the given ev...">profcl_profile_add</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, <span class="keyword">const</span> <span class="keywordtype">char</span>* event_name, <a class="code" href="structcl_event.html" title="Stub for cl_event objects. ">cl_event</a> ev, GError** err) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">/* Just call profcl_profile_add_composite sending the same event as start and end event. */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="clprofiler_8c.html#a6e60e95aa1526a42bc97994594fa03fe" title="Add OpenCL events to events profile, more specifically adds the start of ev1 and end of ev2 to the pr...">profcl_profile_add_composite</a>(profile, event_name, ev, ev, err);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a6e60e95aa1526a42bc97994594fa03fe">  143</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#a6e60e95aa1526a42bc97994594fa03fe" title="Add OpenCL events to events profile, more specifically adds the start of ev1 and end of ev2 to the pr...">profcl_profile_add_composite</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, <span class="keyword">const</span> <span class="keywordtype">char</span>* event_name, <a class="code" href="structcl_event.html" title="Stub for cl_event objects. ">cl_event</a> ev1, <a class="code" href="structcl_event.html" title="Stub for cl_event objects. ">cl_event</a> ev2, GError** err) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* OpenCL return status. */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="test__profiler_8h.html#acb66e7b68fd648501579ef19dc41265a" title="Replaces OpenCL cl_int type. ">cl_int</a> ocl_status;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">/* Function return status. */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> ret_status; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">/* Unique event ID. */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        guint* unique_event_id;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">/* Command queues ID. */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        guint* queue_id;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">/* Specific event ID. */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        guint event_id;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">/* Event instant. */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> instant;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">/* Event instant objects. */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* evinst_start;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* evinst_end;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">/* Command queues to which the events are associated to. */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="test__profiler_8h.html#aff736eb04c08c6d463cceb54ccb9eae0" title="Replaces OpenCL cl_command_queue type. ">cl_command_queue</a> q1, q2;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">/* Check if event is already registered in the unique events table... */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (!g_hash_table_contains(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>, event_name)) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="comment">/* ...if not, register it. */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                unique_event_id = </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        GUINT_TO_POINTER(g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                g_hash_table_insert(</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>, </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        (gpointer) event_name, </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        (gpointer) unique_event_id);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">/* Update number of event instants, and get an ID for the given event. */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        event_id = ++profile-&gt;<a class="code" href="structprofcl__profile.html#ad2570f72c56aeee39715780c0eba9ac3">num_event_instants</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">/* Get command queue associated with start event. */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        ocl_status = <a class="code" href="test__profiler_8c.html#a73367e273f40a9a0f0d2f5cd68eb5e72" title="Stub for clGetEventInfo function. ">clGetEventInfo</a>(</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                ev1, </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <a class="code" href="test__profiler_8h.html#acdf4b26037faa49e8a1908ad7984a490a20208e0bcbb483605953730928e0aa4a">CL_EVENT_COMMAND_QUEUE</a>, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#aff736eb04c08c6d463cceb54ccb9eae0" title="Replaces OpenCL cl_command_queue type. ">cl_command_queue</a>), </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                &amp;q1, </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                NULL);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                *err, </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594" title="OpenCL success code. ">CL_SUCCESS</a> != ocl_status, </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa01b036208c39621bc1e5dfb7d23563b3">PROFCL_OCL_ERROR</a>, </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                error_handler, </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="stringliteral">&quot;Get start event command queue: OpenCL error %d (%s).&quot;</span>, </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                ocl_status,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d" title="Convert OpenCL error code to a readable string. ">clerror_get</a>(ocl_status));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">/* Get event start instant. */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        ocl_status = <a class="code" href="test__profiler_8c.html#a1203915fa89fa2ad0914bc8b83e1af81" title="Stub for clGetEventProfilingInfo function. ">clGetEventProfilingInfo</a>(</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                ev1, </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <a class="code" href="test__profiler_8h.html#a1a9b7106293f000ecdfc8eddaf287844a8d809fc8ce45649442ff59a4e9709c79">CL_PROFILING_COMMAND_START</a>, </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>), </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                &amp;instant, </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                NULL);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                *err, </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594" title="OpenCL success code. ">CL_SUCCESS</a> != ocl_status, </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa01b036208c39621bc1e5dfb7d23563b3">PROFCL_OCL_ERROR</a>, </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                error_handler, </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="stringliteral">&quot;Get event start instant: OpenCL error %d (%s).&quot;</span>, </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                ocl_status,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d" title="Convert OpenCL error code to a readable string. ">clerror_get</a>(ocl_status));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">/* Check if start instant is the oldest instant. If so, keep it. */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (instant &lt; profile-&gt;startTime)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#a88a3c702107196d5d1e761603ebd598e">startTime</a> = instant;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">/* Add event start instant to list of event instants. */</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        evinst_start = <a class="code" href="clprofiler_8c.html#a24026837d3ed53f6e87c22de4489c5dc" title="Create new event instant. ">profcl_evinst_new</a>(</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                event_name, </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                event_id, </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                instant, </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24a4d405c57c00091b11a5a46910616587c">PROFCL_EV_START</a>, </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                q1);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                *err, </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                evinst_start == NULL, </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                error_handler, </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="stringliteral">&quot;Unable to allocate memory for ProfCLEvInst object for start of event &#39;%s&#39; with ID %d.&quot;</span>, </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                event_name, </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                event_id);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = g_list_prepend(</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                (gpointer) evinst_start);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">/* Get command queue associated with end event. */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        ocl_status = <a class="code" href="test__profiler_8c.html#a73367e273f40a9a0f0d2f5cd68eb5e72" title="Stub for clGetEventInfo function. ">clGetEventInfo</a>(</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                ev2, </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="test__profiler_8h.html#acdf4b26037faa49e8a1908ad7984a490a20208e0bcbb483605953730928e0aa4a">CL_EVENT_COMMAND_QUEUE</a>, </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#aff736eb04c08c6d463cceb54ccb9eae0" title="Replaces OpenCL cl_command_queue type. ">cl_command_queue</a>), </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                &amp;q2, </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                NULL);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                *err, <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594" title="OpenCL success code. ">CL_SUCCESS</a> != ocl_status, </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa01b036208c39621bc1e5dfb7d23563b3">PROFCL_OCL_ERROR</a>, </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                error_handler, </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="stringliteral">&quot;Get end event command queue: OpenCL error %d (%s).&quot;</span>, </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                ocl_status,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d" title="Convert OpenCL error code to a readable string. ">clerror_get</a>(ocl_status));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">/* Get event end instant. */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        ocl_status = <a class="code" href="test__profiler_8c.html#a1203915fa89fa2ad0914bc8b83e1af81" title="Stub for clGetEventProfilingInfo function. ">clGetEventProfilingInfo</a>(</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                ev2, </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="test__profiler_8h.html#a1a9b7106293f000ecdfc8eddaf287844a7854a56c6ae3345c153d9e8a2f7595c2">CL_PROFILING_COMMAND_END</a>, </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>), </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                &amp;instant, </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                NULL);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                *err, <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <a class="code" href="test__profiler_8h.html#a945238394cd7f518e7196ec80ea74594" title="OpenCL success code. ">CL_SUCCESS</a> != ocl_status, </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa01b036208c39621bc1e5dfb7d23563b3">PROFCL_OCL_ERROR</a>, </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                error_handler, </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="stringliteral">&quot;Get event end instant: OpenCL error %d (%s).&quot;</span>, </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                ocl_status,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <a class="code" href="clerrors_8c.html#aa4b9b02b920eb270989434ab3b4d468d" title="Convert OpenCL error code to a readable string. ">clerror_get</a>(ocl_status))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">/* Add event end instant to list of event instants. */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        evinst_end = <a class="code" href="clprofiler_8c.html#a24026837d3ed53f6e87c22de4489c5dc" title="Create new event instant. ">profcl_evinst_new</a>(</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                event_name, </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                event_id, </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                instant, </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24a5485f99b6fd76bfa8f13cd8b88d58943">PROFCL_EV_END</a>, </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                q2);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                *err, <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                evinst_end == NULL, </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                error_handler, </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="stringliteral">&quot;Unable to allocate memory for ProfCLEvInst object for end of event &#39;%s&#39; with ID %d.&quot;</span>, </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                event_name, </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                event_id);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = g_list_prepend(</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                (gpointer) evinst_end);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">/* Check if command queue of start event is already registered in the command queues table... */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (!g_hash_table_contains(profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, q1)) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="comment">/* ...if not, register it. */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                queue_id = GUINT_TO_POINTER(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                g_hash_table_insert(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, (gpointer) q1, (gpointer) queue_id);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">/* Check if command queue of end event is already registered in the command queues table... */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (!g_hash_table_contains(profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, q2)) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="comment">/* ...if not, register it. */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                queue_id = GUINT_TO_POINTER(</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                g_hash_table_insert(</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, (gpointer) q2, (gpointer) queue_id);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;error_handler:</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;finish: </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">return</span> ret_status;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a24026837d3ed53f6e87c22de4489c5dc">  332</a></span>&#160;<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* <a class="code" href="clprofiler_8c.html#a24026837d3ed53f6e87c22de4489c5dc" title="Create new event instant. ">profcl_evinst_new</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* eventName, guint <span class="keywordtype">id</span>, <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> instant, <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24" title="Type of event instant (ProfCLEvInst). ">ProfCLEvInstType</a> type, <a class="code" href="test__profiler_8h.html#aff736eb04c08c6d463cceb54ccb9eae0" title="Replaces OpenCL cl_command_queue type. ">cl_command_queue</a> queue) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">/* Allocate memory for event instant data structure. */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* event_instant = </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">/* If allocation successful... */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (event_instant != NULL) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="comment">/* ...initialize structure fields. */</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                event_instant-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a> = eventName;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                event_instant-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> = id;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                event_instant-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> = instant;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                event_instant-&gt;<a class="code" href="structprofcl__evinst.html#a40e7165a2e4f12fc26aacc2777c82f12">type</a> = type;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                event_instant-&gt;<a class="code" href="structprofcl__evinst.html#a988c9f1e4177a0d30ee97b704174062c">queue</a> = queue;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">/* Return event instant data structure. */</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span> event_instant;   </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#af956e346e38f858f4608983a27fc853a">  356</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#af956e346e38f858f4608983a27fc853a" title="Free an event instant. ">profcl_evinst_free</a>(gpointer event_instant) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        free(event_instant);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#adf506a70217a22dff590a13a917eddda">  369</a></span>&#160;gint <a class="code" href="clprofiler_8c.html#adf506a70217a22dff590a13a917eddda" title="Compares two event instants for sorting within a GList. It is an implementation of GCompareDataFunc f...">profcl_evinst_comp</a>(gconstpointer a, gconstpointer b, gpointer userdata) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">/* Cast input parameters to event instant data structures. */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* evInst1 = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) a;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* evInst2 = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) b;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958" title="Sorting strategy for event instants (ProfCLEvInst). ">ProfCLEvSort</a>* sortType = (<a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958" title="Sorting strategy for event instants (ProfCLEvInst). ">ProfCLEvSort</a>*) userdata;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">/* Perform comparison. */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span> (*sortType == <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958a67d14ffa35a05109ad878b7cb61e6b9f">PROFCL_EV_SORT_INSTANT</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="comment">/* Sort by instant */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> &gt; evInst2-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>) <span class="keywordflow">return</span>  1;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> &lt; evInst2-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*sortType == <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958a466fff1cdc0d943a4868a7c01d7fa595">PROFCL_EV_SORT_ID</a>) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="comment">/* Sort by ID */</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &gt; evInst2-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a>) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &lt; evInst2-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a40e7165a2e4f12fc26aacc2777c82f12">type</a> == <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24a5485f99b6fd76bfa8f13cd8b88d58943">PROFCL_EV_END</a>) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordflow">if</span> (evInst1-&gt;<a class="code" href="structprofcl__evinst.html#a40e7165a2e4f12fc26aacc2777c82f12">type</a> == <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24a4d405c57c00091b11a5a46910616587c">PROFCL_EV_START</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a70a73353a261c66bec521bf64a228812">  400</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#a70a73353a261c66bec521bf64a228812" title="Determine overlap matrix for the given OpenCL events profile. Must be called after profcl_profile_agg...">profcl_profile_overmat</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, GError** err) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">/* Total overlap time. */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> totalOverlap = 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">/* Overlap matrix. */</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>* overlapMatrix = NULL;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">/* Number of unique events. */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        guint numUniqEvts;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="comment">/* Helper table to account for all overlapping events. */</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        GHashTable* overlaps = NULL;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">/* Occurring events table. */</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        GHashTable* eventsOccurring = NULL;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">/* Type of sorting to perform. */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958" title="Sorting strategy for event instants (ProfCLEvInst). ">ProfCLEvSort</a> sortType;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">/* Container for current event instants. */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        GList* currEvInstContainer;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">/* Determine number of unique events. */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        numUniqEvts = g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">/* Initialize overlap matrix. */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        overlapMatrix = </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                (<a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>*) malloc(numUniqEvts * numUniqEvts * <span class="keyword">sizeof</span>(<a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>));</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                *err, </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                overlapMatrix == NULL, </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                error_handler, </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="stringliteral">&quot;Unable to allocate memory for overlapMatrix.&quot;</span>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">for</span> (guint i = 0; i &lt; numUniqEvts * numUniqEvts; i++)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                overlapMatrix[i] = 0;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">/* Initialize helper table to account for all overlapping events. */</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        overlaps = g_hash_table_new(g_direct_hash, g_direct_equal);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                *err, </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                overlaps == NULL, </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                error_handler, </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="stringliteral">&quot;Unable to allocate memory for overlaps helper table: g_hash_table_new function returned NULL.&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="comment">/* Setup ocurring events table (key: eventID, value: uniqueEventID) */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        eventsOccurring = g_hash_table_new(g_int_hash, g_int_equal);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                *err, <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                eventsOccurring == NULL, </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                error_handler, </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="stringliteral">&quot;Unable to allocate memory for occurring events table: g_hash_table_new function returned NULL.&quot;</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">/* Sort all event instants. */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        sortType = <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958a67d14ffa35a05109ad878b7cb61e6b9f">PROFCL_EV_SORT_INSTANT</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = g_list_sort_with_data(</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="clprofiler_8c.html#adf506a70217a22dff590a13a917eddda" title="Compares two event instants for sorting within a GList. It is an implementation of GCompareDataFunc f...">profcl_evinst_comp</a>, </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                (gpointer) &amp;sortType);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">/* Iterate through all event instants */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        currEvInstContainer = profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">while</span> (currEvInstContainer) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="comment">/* Loop aux. variables. */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* currEvInst = NULL;            <span class="comment">/* Current event instant. */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                GHashTable* innerTable = NULL;                <span class="comment">/* Inner hash table (is value for overlap hash table). */</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                GHashTableIter iter;                          <span class="comment">/* Hash table iterator. */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                gpointer key_eid, ueid_curr_ev, ueid_occu_ev; <span class="comment">/* Hashtable key, unique event ID for current event, unique event ID for occurring event. */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                guint eid_key1, eid_key2;                     <span class="comment">/* Keys for start and end event instants. */</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> effOverlap;                          <span class="comment">/* Event overlap in nanoseconds. */</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="comment">/* Get current event instant. */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                currEvInst = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) currEvInstContainer-&gt;data;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="comment">/* Check if event time is START or END time */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                if (currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a40e7165a2e4f12fc26aacc2777c82f12">type</a> == <a class="code" href="clprofiler_8h.html#af9d50fe768dc8543f86370b60c36cc24a4d405c57c00091b11a5a46910616587c">PROFCL_EV_START</a>) { </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="comment">/* Event START instant. */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <span class="comment">/* 1 - Check for overlaps with ocurring events */</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        g_hash_table_iter_init(&amp;iter, eventsOccurring);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        <span class="keywordflow">while</span> (g_hash_table_iter_next (&amp;iter, &amp;key_eid, NULL)) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                <span class="comment">/* The first hash table key will be the smaller event id. */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                eid_key1 = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &lt;= *((guint*) key_eid) </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                        : *((guint*) key_eid);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                <span class="comment">/* The second hash table key will be the larger event id. */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                eid_key2 = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &gt; *((guint*) key_eid) </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                        : *((guint*) key_eid);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                <span class="comment">/* Check if the first key (smaller id) is already in the hash table... */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                <span class="keywordflow">if</span> (!g_hash_table_lookup_extended(overlaps, </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                        GUINT_TO_POINTER(eid_key1), NULL, </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                        (gpointer) &amp;innerTable)) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                        <span class="comment">/* ...if not in table, add it to table, creating a new </span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">                                         * inner table as value. Inner table will be initalized </span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">                                         * with second key (larger id) as key and event start </span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">                                         * instant as value. */</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                        innerTable = g_hash_table_new_full(</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                g_direct_hash, </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                g_direct_equal, </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                                NULL, </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                                (GDestroyNotify) g_hash_table_destroy);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                                *err, </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                                innerTable == NULL, </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                error_handler, </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                                <span class="stringliteral">&quot;Unable to allocate memory for events inner table: g_hash_table_new_full function returned NULL.&quot;</span>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                        g_hash_table_insert(</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                                overlaps, GUINT_TO_POINTER(eid_key1), innerTable);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                <span class="comment">/* Add second key (larger id) to inner tabler, setting the </span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">                                 * start instant as the value. */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                g_hash_table_insert(</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                        innerTable, </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                        GUINT_TO_POINTER(eid_key2), </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                        &amp;(currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>));</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <span class="comment">/* 2 - Add event to occurring events. */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        g_hash_table_insert(</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                eventsOccurring, </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                &amp;(currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a>), <span class="comment">/* eid */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                g_hash_table_lookup(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>, currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>) <span class="comment">/* ueid */</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        ); </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        <span class="comment">/* Event END instant. */</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        <span class="comment">/* 1 - Remove event from ocurring events */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        g_hash_table_remove(eventsOccurring, &amp;(currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a>));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        <span class="comment">/* 2 - Check for overlap termination with current events */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        g_hash_table_iter_init(&amp;iter, eventsOccurring);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="keywordflow">while</span> (g_hash_table_iter_next(&amp;iter, &amp;key_eid, &amp;ueid_occu_ev)) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                <span class="comment">/* The first hash table key will be the smaller event id. */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                eid_key1 = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &lt;= *((guint*) key_eid) </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                        : *((guint*) key_eid);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                <span class="comment">/* The second hash table key will be the larger event id. */</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                eid_key2 = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> &gt; *((guint*) key_eid) </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a7bf15aa057e3318d9fe3c184f34fd733">id</a> </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                        : *((guint*) key_eid);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                <span class="comment">/* Get effective overlap in nanoseconds. */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                innerTable = g_hash_table_lookup(</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                        overlaps, GUINT_TO_POINTER(eid_key1));</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                effOverlap = </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                        currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                        - </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                        *((<a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a>*) g_hash_table_lookup(</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                innerTable, GUINT_TO_POINTER(eid_key2)));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                <span class="comment">/* Add overlap to overlap matrix. */</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                ueid_curr_ev = g_hash_table_lookup(</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                        profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>, currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                guint ueid_min = GPOINTER_TO_UINT(ueid_curr_ev) &lt;= GPOINTER_TO_UINT(ueid_occu_ev) </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                        ? GPOINTER_TO_UINT(ueid_curr_ev) </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                        : GPOINTER_TO_UINT(ueid_occu_ev);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                guint ueid_max = GPOINTER_TO_UINT(ueid_curr_ev) &gt; GPOINTER_TO_UINT(ueid_occu_ev) </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                        ? GPOINTER_TO_UINT(ueid_curr_ev) </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                        : GPOINTER_TO_UINT(ueid_occu_ev);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                overlapMatrix[ueid_min * numUniqEvts + ueid_max] += effOverlap;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                totalOverlap += effOverlap;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        }       </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="comment">/* Get next event instant. */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                currEvInstContainer = currEvInstContainer-&gt;next;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/* Add a pointer to overlap matrix to the profile. */</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a> = overlapMatrix;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">/* Determine and save effective events time. */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#abe40a36d90c6b5b30e547d91a638de2b">totalEventsEffTime</a> = profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> - totalOverlap;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;error_handler:</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;finish: </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">/* Free overlaps hash table. */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span> (overlaps) g_hash_table_destroy(overlaps);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">/* Free eventsOccurring hash table. */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (eventsOccurring) g_hash_table_destroy(eventsOccurring);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">return</span> status;  </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a19fc9b6a7600e585a54943d187697c1c">  613</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#a19fc9b6a7600e585a54943d187697c1c" title="Determine aggregate statistics for the given OpenCL events profile. ">profcl_profile_aggregate</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, GError** err) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">/* Hash table iterator. */</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        GHashTableIter iter;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">/* A pointer for a event name. */</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        gpointer eventName;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">/* Aggregate event info. */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* evagg = NULL;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">/* Type of sorting to perform on event list. */</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958" title="Sorting strategy for event instants (ProfCLEvInst). ">ProfCLEvSort</a> sortType;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">/* Aux. pointer for event data structure kept in a GList. */</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        GList* currEvInstContainer = NULL;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">/* A pointer to a ProfCLEvAggregate (agg. event info) variable. */</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        gpointer valueAgg;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="comment">/* Auxiliary aggregate event info variable.*/</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* currAgg = NULL;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">/* Initalize table, and set aggregate values to zero. */</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        g_hash_table_iter_init(&amp;iter, profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">while</span> (g_hash_table_iter_next(&amp;iter, &amp;eventName, NULL)) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                evagg = <a class="code" href="clprofiler_8c.html#ae9754e82fde867321fbb8149803334d8" title="Create a new aggregate statistic for events of a given type. ">profcl_aggregate_new</a>(eventName);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        *err, </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        evagg == NULL, </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        <span class="stringliteral">&quot;Unable to allocate memory for ProfCLEvAggregate object.&quot;</span>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                evagg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a> = 0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                g_hash_table_insert(profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>, eventName, (gpointer) evagg);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">/* Sort event instants by eid, and then by START, END order. */</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        sortType = <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958a466fff1cdc0d943a4868a7c01d7fa595">PROFCL_EV_SORT_ID</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = g_list_sort_with_data(</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, <a class="code" href="clprofiler_8c.html#adf506a70217a22dff590a13a917eddda" title="Compares two event instants for sorting within a GList. It is an implementation of GCompareDataFunc f...">profcl_evinst_comp</a>, (gpointer) &amp;sortType);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">/* Iterate through all event instants and determine total times. */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        currEvInstContainer = profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">while</span> (currEvInstContainer) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="comment">/* Loop aux. variables. */</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* currEvInst = NULL;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> startInst, endInst;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="comment">/* Get START event instant. */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                currEvInst = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) currEvInstContainer-&gt;data;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                startInst = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="comment">/* Get END event instant */</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                currEvInstContainer = currEvInstContainer-&gt;next;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                currEvInst = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) currEvInstContainer-&gt;data;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                endInst = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="comment">/* Add new interval to respective aggregate value. */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                currAgg = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) g_hash_table_lookup(</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>, currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                currAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a> += endInst - startInst;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> += endInst - startInst;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="comment">/* Get next START event instant. */</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                currEvInstContainer = currEvInstContainer-&gt;next;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">/* Determine relative times. */</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        g_hash_table_iter_init(&amp;iter, profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">while</span> (g_hash_table_iter_next(&amp;iter, &amp;eventName, &amp;valueAgg)) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                currAgg = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) valueAgg;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                currAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a7a253737f10b4e7221792a5e20d0bed2">relativeTime</a> = </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        ((double) currAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a>) </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        / </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        ((double) profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;error_handler:</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;finish: </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">return</span> status;          </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#ae9754e82fde867321fbb8149803334d8">  714</a></span>&#160;<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* <a class="code" href="clprofiler_8c.html#ae9754e82fde867321fbb8149803334d8" title="Create a new aggregate statistic for events of a given type. ">profcl_aggregate_new</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* eventName) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* agg = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>));</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span> (agg != NULL) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                agg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a> = eventName;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">return</span> agg;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a6188226c3bd091c865aca7db836038a1">  727</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#a6188226c3bd091c865aca7db836038a1" title="Free an aggregate statistic. ">profcl_aggregate_free</a>(gpointer agg) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        free(agg);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="code" href="clprofiler_8c.html#a31c7bb0c3468b4907f8ee4cf1daf910f">  740</a></span>&#160;gint <a class="code" href="clprofiler_8c.html#a31c7bb0c3468b4907f8ee4cf1daf910f" title="Compares two aggregate event data instances for sorting within a GList. It is an implementation of GC...">profcl_evagg_comp</a>(gconstpointer a, gconstpointer b, gpointer userdata) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">/* Cast input parameters to event instant data structures. */</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* evAgg1 = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) a;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* evAgg2 = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) b;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6" title="Sorting strategy for aggregate event data instances. ">ProfCLEvAggDataSort</a>* sortType = (<a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6" title="Sorting strategy for aggregate event data instances. ">ProfCLEvAggDataSort</a>*) userdata;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="comment">/* Perform comparison. */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (*sortType == <a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6a5dd84503b74352cc1a066f7ddca43e60">PROFCL_AGGEVDATA_SORT_NAME</a>) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment">/* Sort by event name */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="keywordflow">return</span> strcmp(evAgg1-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>, evAgg2-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*sortType == <a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6a73e835e914af1e12944ef79a4c185bdf">PROFCL_AGGEVDATA_SORT_TIME</a>) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="comment">/* Sort by event time period */</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordflow">if</span> (evAgg1-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a> &lt; evAgg2-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a>) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="keywordflow">if</span> (evAgg1-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a> &gt; evAgg2-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a>) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;}</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#abd2e222ebad6d1ce9015c820a5b7016d">  763</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#abd2e222ebad6d1ce9015c820a5b7016d" title="Indication that profiling sessions has started. Starts the global profiler timer. ...">profcl_profile_start</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment">/* Start timer. */</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a> = g_timer_new();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;}</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a7785d2882c29b90924130e3c69837d7d">  776</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#a7785d2882c29b90924130e3c69837d7d" title="Indication that profiling sessions has ended. Stops the global profiler timer. ">profcl_profile_stop</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="comment">/* Stop timer. */</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        g_timer_stop(profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a82adb4e9535ffe733b79f48d1d6fbaf8">  791</a></span>&#160;gdouble <a class="code" href="clprofiler_8c.html#a82adb4e9535ffe733b79f48d1d6fbaf8" title="If profiling has started but not stopped, returns the time since the profiling started. If profiling has been stopped, returns the elapsed time between the time it started and the time it stopped. ">profcl_time_elapsed</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="comment">/* Stop timer. */</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">return</span> g_timer_elapsed(profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a>, NULL);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;}</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#ad0626ca896792759a54295bed08fa87d">  808</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#ad0626ca896792759a54295bed08fa87d" title="Print profiling info. ">profcl_print_info</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, <a class="code" href="clprofiler_8h.html#a90f18e84e6df75461fa0bbfca8271ac6" title="Sorting strategy for aggregate event data instances. ">ProfCLEvAggDataSort</a> evAggSortType, GError** err) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="comment">/* Function return status. */</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="comment">/* Auxiliary hash table. */</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        GHashTable* tmp = NULL;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment">/* Auxiliary hash table iterator. */</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        GHashTableIter iter;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">/* Auxiliary pointers for data within hash tables and lists. */</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        gpointer pEventName, pId;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="comment">/* List of aggregate events. */</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        GList* evAggList = NULL;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">/* List of aggregate events (traversing pointer). */</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        GList* evAggContainer = NULL;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">/* Aggregate event info. */</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>* evAgg = NULL;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">/* Number of unique event names. */</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        guint numUniqEvts;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">/* String containing description of overlapping events. */</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        GString* overlapString = NULL;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        printf(<span class="stringliteral">&quot;\n   =========================== Timming/Profiling ===========================\n\n&quot;</span>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">/* Show total ellapsed time */</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a>) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                printf(</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        <span class="stringliteral">&quot;     Total ellapsed time       : %fs\n&quot;</span>, </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        g_timer_elapsed(profile-&gt;<a class="code" href="structprofcl__profile.html#a74421b834d52c638084568e39a6882c0">timer</a>, NULL));</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="comment">/* Show total events time */</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> &gt; 0) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                printf(</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        <span class="stringliteral">&quot;     Total of all events       : %fs\n&quot;</span>, </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> * 1e-9);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">/* Show aggregate event times */</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> (g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>) &gt; 0) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                printf(<span class="stringliteral">&quot;     Aggregate times by event  :\n&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                evAggList = g_hash_table_get_values(profile-&gt;<a class="code" href="structprofcl__profile.html#ad98f73cee9cc475a4a292099b2c534e6">aggregate</a>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        *err, </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                        <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                        evAggList == NULL, </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                        <span class="stringliteral">&quot;Unable to allocate memory for GList object &#39;evAggList&#39;.&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                evAggList = g_list_sort_with_data(</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                        evAggList, <a class="code" href="clprofiler_8c.html#a31c7bb0c3468b4907f8ee4cf1daf910f" title="Compares two aggregate event data instances for sorting within a GList. It is an implementation of GC...">profcl_evagg_comp</a>, &amp;evAggSortType);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                evAggContainer = evAggList;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                printf(<span class="stringliteral">&quot;       | Event name                     | Rel. time (%%) | Abs. time (s) |\n&quot;</span>);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <span class="keywordflow">while</span> (evAggContainer) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        evAgg = (<a class="code" href="structprofcl__ev__aggregate.html" title="Aggregate event info. ">ProfCLEvAggregate</a>*) evAggContainer-&gt;data;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        g_assert(evAgg != NULL);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                        printf(</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                <span class="stringliteral">&quot;       | %-30.30s | %13.4f | %13.4e |\n&quot;</span>, </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                evAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>, </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                evAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a7a253737f10b4e7221792a5e20d0bed2">relativeTime</a> * 100.0, </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                evAgg-&gt;<a class="code" href="structprofcl__ev__aggregate.html#a57591207f070e00684e4159a0c82d4a8">totalTime</a> * 1e-9);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        evAggContainer = evAggContainer-&gt;next;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="comment">/* Show overlaps */</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a>) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                <span class="comment">/* Create new temporary hash table which is the reverse in </span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">                 * terms of key-values of profile-&gt;unique_events. */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                tmp = g_hash_table_new(g_direct_hash, g_direct_equal);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        *err, </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                        tmp == NULL, </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaa664ddc87c28b748f0de535bb76406c3">PROFCL_ALLOC_ERROR</a>, </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        error_handler, </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                        <span class="stringliteral">&quot;Unable to allocate memory for &#39;tmp&#39; table: g_hash_table_new function returned NULL.&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="comment">/* Populate temporary hash table. */</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                g_hash_table_iter_init(&amp;iter, profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keywordflow">while</span> (g_hash_table_iter_next(&amp;iter, &amp;pEventName, &amp;pId)) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        g_hash_table_insert(tmp, pId, pEventName);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                <span class="comment">/* Get number of unique events. */</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                numUniqEvts = g_hash_table_size(profile-&gt;<a class="code" href="structprofcl__profile.html#a380058665c128b9a3dde28b3f1618c8c">unique_events</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="comment">/* Show overlaps. */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                overlapString = g_string_new(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="keywordflow">for</span> (guint i = 0; i &lt; numUniqEvts; i++) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                        <span class="keywordflow">for</span> (guint j = 0; j &lt; numUniqEvts; j++) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                <span class="keywordflow">if</span> (profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a>[i * numUniqEvts + j] &gt; 0) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                        g_string_append_printf(</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                overlapString,</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                                <span class="stringliteral">&quot;       | %-22.22s | %-22.22s | %12.4e |\n&quot;</span>, </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                                (<span class="keyword">const</span> <span class="keywordtype">char</span>*) g_hash_table_lookup(</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                                        tmp, GUINT_TO_POINTER(i)),</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                                (<span class="keyword">const</span> <span class="keywordtype">char</span>*) g_hash_table_lookup(</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                                        tmp, GUINT_TO_POINTER(j)),</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                profile-&gt;<a class="code" href="structprofcl__profile.html#a5473ac9fd3cc01c71d70da8e58e1cba0">overmat</a>[i * numUniqEvts + j] * 1e-9</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                        );</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="keywordflow">if</span> (strlen(overlapString-&gt;str) &gt; 0) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        <span class="comment">/* Show total events effective time (discount overlaps) */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        printf(<span class="stringliteral">&quot;     Tot. of all events (eff.) : %es\n&quot;</span>, </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                profile-&gt;<a class="code" href="structprofcl__profile.html#abe40a36d90c6b5b30e547d91a638de2b">totalEventsEffTime</a> * 1e-9);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        printf(<span class="stringliteral">&quot;                                 %es saved with overlaps\n&quot;</span>, </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                (profile-&gt;<a class="code" href="structprofcl__profile.html#aa155396932bfbbed94f1ff3426ba7a23">totalEventsTime</a> - profile-&gt;<a class="code" href="structprofcl__profile.html#abe40a36d90c6b5b30e547d91a638de2b">totalEventsEffTime</a>) * 1e-9);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        <span class="comment">/* Title the several overlaps. */</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        printf(<span class="stringliteral">&quot;     Event overlap times       :\n&quot;</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                        printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        printf(<span class="stringliteral">&quot;       | Event 1                | Event2                 | Overlap (s)  |\n&quot;</span>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                        printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        <span class="comment">/* Show overlaps table. */</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                        printf(<span class="stringliteral">&quot;%s&quot;</span>, overlapString-&gt;str);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                        printf(<span class="stringliteral">&quot;       ------------------------------------------------------------------\n&quot;</span>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;error_handler:</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;finish: </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="comment">/* Free stuff. */</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">if</span> (evAggList) g_list_free(evAggList);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">if</span> (overlapString) g_string_free(overlapString, TRUE);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> (tmp) g_hash_table_destroy(tmp);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">return</span> status;                  </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#aec62e87a18d8bb81dfed1ab00cd998e9">  979</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#aec62e87a18d8bb81dfed1ab00cd998e9" title="Export profiling info to a given stream. ">profcl_export_info</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, FILE* stream, GError** err) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordtype">int</span> ret_status, write_status;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">/* Type of sorting to perform on event list. */</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958" title="Sorting strategy for event instants (ProfCLEvInst). ">ProfCLEvSort</a> sortType;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">/* List of event instants (traversing pointer). */</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        GList* evInstContainer = NULL;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">/* Make sure profile is not NULL. */</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        g_assert(profile != NULL);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">/* Sort event instants by eid, and then by START, END order. */</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        sortType = <a class="code" href="clprofiler_8h.html#a72033ed7aacb115afe272f9fd91c8958a466fff1cdc0d943a4868a7c01d7fa595">PROFCL_EV_SORT_ID</a>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a> = g_list_sort_with_data(</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>, <a class="code" href="clprofiler_8c.html#adf506a70217a22dff590a13a917eddda" title="Compares two event instants for sorting within a GList. It is an implementation of GCompareDataFunc f...">profcl_evinst_comp</a>, (gpointer) &amp;sortType);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="comment">/* Iterate through all event instants, determine complete event</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">         * information and export it to stream. */</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        evInstContainer = profile-&gt;<a class="code" href="structprofcl__profile.html#ab9d7da460ea1f5caf70824cba8a41fd6">event_instants</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="keywordflow">while</span> (evInstContainer) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <span class="comment">/* Loop aux. variables. */</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>* currEvInst = NULL;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                gulong q1, q2;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                gulong qId;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <a class="code" href="test__profiler_8h.html#a48a53eb28662a9c2be46a803a3b2cc07" title="Replaces OpenCL cl_ulong type. ">cl_ulong</a> startInst, endInst;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *ev1Name, *ev2Name;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                <span class="comment">/* Get information from start instant. */</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                currEvInst = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) evInstContainer-&gt;data;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                startInst = export_options.<a class="code" href="structprofcl__export__options.html#a2126ca1b36bc92df5149759fa1275407">zero_start</a> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> - profile-&gt;<a class="code" href="structprofcl__profile.html#a88a3c702107196d5d1e761603ebd598e">startTime</a> </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                        : currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                q1 = export_options.<a class="code" href="structprofcl__export__options.html#ace2642c3ecb79618bf423be6221e257c">simple_queue_id</a> </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                        ? (gulong) GPOINTER_TO_UINT(</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                g_hash_table_lookup(</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                        profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a988c9f1e4177a0d30ee97b704174062c">queue</a>)) </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                        : (gulong) currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a988c9f1e4177a0d30ee97b704174062c">queue</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                ev1Name = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="comment">/* Get information from end instant. */</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                evInstContainer = evInstContainer-&gt;next;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                currEvInst = (<a class="code" href="structprofcl__evinst.html" title="Event instant. ">ProfCLEvInst</a>*) evInstContainer-&gt;data;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                endInst = export_options.<a class="code" href="structprofcl__export__options.html#a2126ca1b36bc92df5149759fa1275407">zero_start</a> </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                        ? currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a> - profile-&gt;<a class="code" href="structprofcl__profile.html#a88a3c702107196d5d1e761603ebd598e">startTime</a> </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        : currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a927aea83d749d8cae4c8ee63549d67d0">instant</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                q2 = export_options.<a class="code" href="structprofcl__export__options.html#ace2642c3ecb79618bf423be6221e257c">simple_queue_id</a> </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        ? (gulong) GPOINTER_TO_UINT(</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                g_hash_table_lookup(</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                        profile-&gt;<a class="code" href="structprofcl__profile.html#a304374f67cfe586e89c09a5f42e5a466">command_queues</a>, currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a988c9f1e4177a0d30ee97b704174062c">queue</a>)) </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        : (gulong) currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a988c9f1e4177a0d30ee97b704174062c">queue</a>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                ev2Name = currEvInst-&gt;<a class="code" href="structprofcl__evinst.html#a588256e9f596ec4a4d1396a554a68d3f">eventName</a>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                <span class="comment">/* Make sure both event instants correspond to the same event. */</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                g_assert_cmpstr(ev1Name, ==, ev2Name);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="comment">/* Make sure start instant occurs before end instant. */</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                g_assert_cmpint(startInst, &lt;, endInst);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <span class="comment">/* Determine queue Id. */</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                qId = (q1 == q2) ? q1 : (q1 + q2);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="comment">/* Write to stream. */</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                write_status = fprintf(stream, <span class="stringliteral">&quot;%s%lu%s%s%lu%s%lu%s%s%s%s%s&quot;</span>, </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#afdce9c9887e6d50738cecb8c89a93fbb">queue_delim</a>, </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                        qId, </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#afdce9c9887e6d50738cecb8c89a93fbb">queue_delim</a>, </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#af95374946392a9c5b50bbfa9ea6762ed">separator</a>, </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) startInst, </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#af95374946392a9c5b50bbfa9ea6762ed">separator</a>, </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) endInst, </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#af95374946392a9c5b50bbfa9ea6762ed">separator</a>, </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#a954c00e12170d5bb434613b21431d4dc">evname_delim</a>, </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        ev1Name, </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#a954c00e12170d5bb434613b21431d4dc">evname_delim</a>,</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        export_options.<a class="code" href="structprofcl__export__options.html#afe7cadc32c6ceb7093a860073cba9aee">newline</a>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        *err, </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        write_status &lt; 0, </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaafa951fbf312b530e6de163d179e9353f">PROFCL_ERROR_STREAM_WRITE</a>, </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        error_handler, </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        <span class="stringliteral">&quot;Error while exporting profiling information (writing to stream).&quot;</span>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="comment">/* Get next START event instant. */</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                evInstContainer = evInstContainer-&gt;next;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        g_assert (err == NULL || *err == NULL);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        ret_status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;error_handler:</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;finish: </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="comment">/* Return status. */</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">return</span> ret_status;              </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a86997b1b0294b548e91b0c36b0e337dd"> 1097</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="clprofiler_8c.html#a86997b1b0294b548e91b0c36b0e337dd" title="Helper function which exports profiling info to a given file, automatically opening and closing the f...">profcl_export_info_file</a>(<a class="code" href="structprofcl__profile.html" title="Contains the profiling info of an OpenCL application. ">ProfCLProfile</a>* profile, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename, GError** err) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">/* Aux. var. */</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="comment">/* Internal GError object. */</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        GError* errInt = NULL;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="comment">/* Open file. */</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        FILE* fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <a class="code" href="gerrorf_8h.html#abdf75fa50067bf84ba1274d7ade17c5a" title="If error is detected (error_code != no_error_code), create an error object (GError) and go to the spe...">gef_if_error_create_goto</a>(</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                *err, </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <a class="code" href="clprofiler_8h.html#a250fe3652a0264766eeaf68104437400">PROFCL_ERROR</a>, </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                fp == NULL, </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaaf10d236b07f57e338081535945c2f2ca">PROFCL_ERROR_OPENFILE</a>, </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                error_handler, </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="stringliteral">&quot;Unable to open file &#39;%s&#39; for exporting.&quot;</span>, </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                filename);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="comment">/* Export data. */</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        status = <a class="code" href="clprofiler_8c.html#aec62e87a18d8bb81dfed1ab00cd998e9" title="Export profiling info to a given stream. ">profcl_export_info</a>(profile, fp, &amp;errInt);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="gerrorf_8h.html#a7dc34fd6e3669ca6536a39868deac1f1" title="Same as gef_if_error_goto(), but rethrows error in a source GError to a new destination GError object...">gef_if_error_propagate_goto</a>(</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                errInt, err, <a class="code" href="gerrorf_8h.html#a0cb60ac0c3a8fa66db7bc90d0b614fc2aede37f72a6b2421a37ea3ad19fe49852">GEF_USE_GERROR</a>, status, error_handler);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="comment">/* If we got here, everything is OK. */</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        g_assert (errInt == NULL);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        status = <a class="code" href="clprofiler_8h.html#a29b189449bf9da85d23de2cd8a7fdaaaa6f3671634849f2385c5cc0020ad000c7">PROFCL_SUCCESS</a>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;error_handler:</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">/* If we got here there was an error, verify that it is so. */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        g_assert (err == NULL || *err != NULL);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">/* Free internal GError object. */</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        g_error_free(errInt);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;finish: </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="comment">/* Close file. */</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">if</span> (fp) fclose(fp);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="comment">/* Return file contents in string form. */</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01147"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a0191cc11f25092c5e92aea6b3a9d0330"> 1147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="clprofiler_8c.html#a0191cc11f25092c5e92aea6b3a9d0330" title="Set export options using a ProfCLExportOptions struct. ">profcl_export_opts_set</a>(<a class="code" href="structprofcl__export__options.html" title="Export options. ">ProfCLExportOptions</a> export_opts) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        export_options = export_opts;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#a807531068b9d10908e8932d35987fb17"> 1156</a></span>&#160; <a class="code" href="structprofcl__export__options.html" title="Export options. ">ProfCLExportOptions</a> <a class="code" href="clprofiler_8c.html#a807531068b9d10908e8932d35987fb17" title="Get current export options. ">profcl_export_opts_get</a>() {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="keywordflow">return</span> export_options;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"><a class="code" href="clprofiler_8h.html#af6a9d5ad9b715dab701d806ceecbf82a"> 1166</a></span>&#160;GQuark <a class="code" href="clprofiler_8c.html#abe4d993317cc5b41eed5c37af7248bbf" title="Resolves to error category identifying string, in this case an error in the OpenCL profiler library...">profcl_error_quark</a>() {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">return</span> g_quark_from_static_string(<span class="stringliteral">&quot;profcl-error-quark&quot;</span>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 5 2014 20:38:52 for cf4ocl (C Framework for OpenCL) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
